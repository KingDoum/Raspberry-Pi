
# 背景
当前购买了一个4核16G的Linux主机，作为个人学习使用，CPU是N5105，固态硬盘是256G。
主要用来部署自己的各种云服务，同时可以跑一些脚本之类的数据。
由于路由器出了问题，所以购买了一个新的 中兴巡天 AX3000 pro 作为新的路由器，进行使用。
偷懒，把所有的端口都打开，直接全部端口转发，结果发现 自己的服务器貌似被攻击了。

## 如何发现？
主要是通过通过 htop 发现clash 容器端口 突然占据了大量内存，以前日常总内存是1.2G左右，7.10日，内存突然暴涨到3G左右，经过大量的排查
发现是我的clash 代理端口 被人扫描到，然后直接被使用了，白嫖了我的端口转发和特殊功能。 这就让我非常生气。
【被白嫖代理之后，我就把7080公网端口给关闭了】
事后的教训就是 路由器端口还是需要手动开启，不能全局转发，尤其是针对一些专门内网的项目，全部给限制住。


其次 我查看服务器 日志 ：nano /var/log/auth.log 
存在大量没见过的ip地址，疯狂在尝试使用SSH登录我的服务器，不断的通过各种用户名包括且不限于 root git pi git1 这种尝试登录，然后使用弱密码进行访问。

吓得我连夜采取措施
- 使用密钥对进行访问，禁止密码访问
- 安装防止爆破的软件，对不认识的流量且错误超过3次的IP 进行封禁

安装的软件： fail2ban，他的主要作用是防止SSH暴力破解，通过iptables对IP进行封禁。
后续在部署主机的时候，一定要额外注意这一点，安全挺重要的
